#!/usr/bin/env ruby
# -*- coding: utf-8 -*-

require 'rubygems'
require 'rspec'
require 'json'

class Reducer
  def self.run
    `cat data/* | ruby lib/mapper.rb | sort | ruby lib/reducer.rb`
  end
end

describe Reducer do
  it 'should create json from the word vector' do
    expected = "215th\t384247201\t{}\nAVE_VH\t33997115\t{\"夕方\":1,\"我慢\":1}\nComunklam\t51779122\t{\"Syzygy\":1,\"things\":1,\"http\":1,\"jkuChE\":1,\"vía\":1,\"sharethis\":1}\nD_Rascal774\t302478773\t{\"幼女\":1,\"胸\":1}\nFTTH\t15256802\t{\"売春\":1,\"運営\":1,\"容疑\":1,\"警視庁\":1,\"逮捕\":1,\"日本経済新聞\":1,\"http\":1,\"qIMwB\":1}\nFyar_Fy\t159048962\t{\"ayo\":1,\"mulai\":2,\"PKL\":1,\"nha\":1,\"bosan\":1}\nKhloe_m\t128598479\t{\"拳\":1,\"王\":1,\"変換\":1}\nMOOTAAKAA\t113861037\t{\"俺\":1,\"確認\":1}\nMyu_x2\t85549181\t{\"友人\":1,\"持ち\":1}\nRemopuu\t612406805\t{}\nSoUyarukinai\t17594347\t{}\nWa11abie\t112975633\t{\"鉄砲\":1,\"弾\":1,\"仏具\":1,\"供出\":1,\"数\":1,\"十\":1,\"年\":1,\"前\":1}\nWanazawawww\t40609053\t{\"包帯\":1,\"男\":1,\"光\":1,\"背\":1}\n___kgi___\t433967752\t{\"hekkun\":1,\"人人\":5,\"人\":1}\n_popkiller_\t8118142\t{\"lack\":1,\"化\":1}\najipo\t16796460\t{\"独立\":1,\"子\":1}\najt0g\t98846372\t{}\nakusil\t51706557\t{\"俺\":1}\nakuwa\t4374341\t{}\namatanoyo\t15675414\t{\"側\":1,\"機能\":1,\"Opera\":1}\naquirax_k\t24518757\t{\"作家\":1,\"音楽家\":2,\"画家\":1,\"岸田\":1,\"劉生\":1}\nasuka\t3593571\t{\"earthquake\":1,\"速報\":1,\"日\":1,\"時\":1,\"分\":1,\"茨城\":1,\"県\":1,\"北部\":1,\"推定\":3,\"地震\":1,\"発生\":1,\"震源\":1,\"http\":1,\"wnRf\":1,\"saigai\":1,\"jishin\":1}\naussalove\t243922386\t{\"様\":1,\"wwwwwwwwww\":1}\nbelnadette\t14349224\t{}\nbrainfs\t16180027\t{\"brainfs\":1,\"今日\":1,\"回\":1,\"http\":1,\"hute\":1,\"nekofier\":1}\nc_box_kotaro\t75344725\t{\"地球\":1,\"武者震い\":1}\nch1k4hk\t113575182\t{\"不動\":1,\"地\":1,\"埼玉\":1}\nchanmomochan10\t975139939\t{\"宇宙\":1}\ncho45\t3701901\t{\"tagomoris\":1,\"cho\":1,\"別\":1}\ncolspan\t5459952\t{}\ncyanpon\t57265464\t{\"museum\":1,\"HUB\":1,\"TOKYO\":1,\"出場\":1,\"者\":1,\"必見\":1,\"涙\":1,\"素\":1,\"敵\":1,\"Bamboo\":1,\"augment\":1,\"日本\":1,\"紹介\":1,\"映像\":1,\"http\":1,\"wBMA\":1}\nesoragoto\t22761928\t{}\nevil07\t15272646\t{\"年\":1,\"https\":1,\"veufdj\":1}\nexe\t3835881\t{\"名作\":2,\"喜\":1,\"国\":2,\"雅彦\":1,\"樹\":1,\"由香\":1,\"正式\":1}\nglpn\t132226732\t{\"以上\":1,\"渋谷\":3,\"凛\":3,\"出\":1}\nhaleit\t25841465\t{}\nhinetmania\t5422082\t{\"速報\":1,\"予想\":1,\"最大\":1,\"震度\":1,\"地震\":1,\"茨城\":1,\"県\":1,\"北部\":1,\"発生\":1,\"模様\":1,\"jishin\":1}\nhirokira\t53420231\t{\"勝利\":1}\nhisamura75\t3988281\t{}\nica\t4601071\t{\"ajipo\":1,\"正社員\":2}\nisikasa\t9789122\t{\"撃壁\":1,\"背水\":1,\"掌\":1,\"好き\":1}\njt_lab\t71432311\t{}\nk_noppi\t11041302\t{\"Ust\":1,\"子\":1,\"www\":1}\nkarausu\t11098932\t{}\nkinbara0054\t114456650\t{\"sarasiru\":1,\"搭載\":1,\"http\":1,\"zcrr\":1}\nkoemu\t4320871\t{}\nkroner_\t57234814\t{}\nkwmsaaaaa\t1068457344\t{\"実希\":1}\nla_yasushi\t381585192\t{\"月\":1}\nlluiin\t77944404\t{\"Favorite\":1,\"Demo\":1,\"DOC\":1,\"Mastermind\":1,\"http\":1,\"dRhzkim\":1,\"SoundCloud\":1}\nmakino0816\t5792402\t{\"様\":1,\"無茶\":1}\nmayPONda\t151637336\t{\"nomisoni\":2,\"今日\":1,\"現在\":1,\"用意\":1,\"本命\":1,\"人\":2,\"義理\":1,\"http\":1}\nmdaisuke\t23722273\t{\"氷川神社\":1,\"埼玉\":1,\"人\":1,\"大宮\":1,\"見所\":1,\"NAVER\":1,\"http\":1,\"LHZ\":1}\nmenuhin\t94905016\t{\"眠\":1,\"眠気\":1}\nmeruhera1118\t816534420\t{}\nmin2fly\t14733905\t{\"図書館\":4,\"university\":1,\"Let\":1,\"enjoy\":1,\"Library\":1,\"Life\":1,\"中央\":1,\"講習\":1,\"会\":1,\"論文\":1,\"書き方\":1,\"文献\":1,\"方\":1,\"入手\":1,\"方法\":1,\"資料\":1,\"公開\":1,\"http\":2,\"xVHR\":1,\"江北\":1,\"存続\":1,\"危機\":1,\"滋賀\":1,\"地域\":1,\"YOMIURI\":1,\"ONLINE\":1,\"読売新聞\":1}\nmizmanju\t10461752\t{}\nmmi_79\t284429472\t{\"限界\":1,\"時半\":1,\"仮眠\":1}\nmosnoopy\t116809226\t{}\nmukaken\t4336001\t{\"地震\":1}\nmyxa_alt\t617897653\t{}\nnakataku90\t349689033\t{\"地震\":1}\nnegiama\t15394570\t{\"地震\":1,\"時\":1,\"震源\":1,\"地\":1,\"post\":1,\"当たり前\":1}\nnopjapan453\t11990972\t{\"夏\":1,\"陽炎\":1}\nnum1\t13480112\t{\"masa\":1,\"com\":1,\"緊急\":1,\"地震\":1,\"速報\":1,\"報\":2,\"最終\":1,\"詳細\":1,\"情報\":1,\"震源\":1,\"茨城\":2,\"県\":2,\"北部\":1,\"最大\":1,\"震度\":2,\"The\":1,\"Last\":1,\"Second\":1,\"表示\":1,\"地域\":1,\"名\":1}\nnununununu\t11572882\t{\"ykZQ\":1,\"切手シート\":1,\"手元\":1}\nnyar125\t106358057\t{\"moe\":1,\"hearts\":1,\"拡散\":1,\"希望\":1,\"直前\":1,\"暁\":1,\"同日\":1,\"開催\":1,\"縁結び\":1,\"神様\":1,\"屋\":1,\"台村\":1,\"LOVE\":1,\"vol\":1,\"月\":1,\"日\":1,\"祝\":1,\"屋台\":1,\"村\":1,\"横丁\":1,\"歳\":1,\"以上\":1,\"独身\":1,\"男女\":1,\"女性\":1,\"円\":2,\"男性\":1,\"http\":1}\nnyonber\t130813410\t{\"回\":1}\nokomania\t95379183\t{\"津波\":1,\"警報\":1}\nomi_asakura\t85289635\t{\"DJWILDPARTY\":1,\"何\":1,\"系\":1,\"お昼\":1}\nonnigmoo\t13658022\t{\"召喚\":1,\"http\":1,\"BGzM\":1}\npirukuru00_\t249012134\t{\"明日\":1,\"寿司\":1}\nqtbrowneyes\t5454612\t{}\nrice_omori\t14442880\t{}\nrrrrryo\t71762311\t{\"uuuuuuuuuuuuu\":1}\nsaku93\t106151353\t{\"恋愛\":2,\"禁止\":2,\"私\":1,\"成人\":1,\"社会\":1,\"人\":1,\"充\":1,\"別\":1,\"自分\":1}\nsally_may\t16042322\t{}\nsan_chan104\t166976355\t{}\nsanjuusan\t36324553\t{\"億\":1,\"市場\":1}\nschiromisu\t60027750\t{\"少女\":1,\"面倒\":1,\"性格\":1,\"変\":1,\"気分\":1}\nshiroari_\t381460614\t{\"揺れ\":1}\nsiegzeon\t14230492\t{}\nsoranyan\t10765462\t{\"oyoide\":1}\nsuraimyu\t164864409\t{}\ntaiyoroden\t124698310\t{}\ntomy_kaira\t287606751\t{\"普通\":1,\"選択肢\":1}\ntotobook2\t6544622\t{\"mobamasu\":1,\"tihiro\":1}\ntoya\t3274831\t{}\nwataryankonyaa\t270437676\t{\"http\":1,\"WLB\":1,\"ARa\":1}\nwhiteball22\t7071642\t{\"地震\":1}\nwireless_RAN\t552662531\t{\"ringonouta\":1,\"bot\":1,\"明日\":1,\"今\":1,\"月\":1,\"負け犬\":1,\"椎名\":1,\"林檎\":1,\"ringo\":1}\nxoj\t6111032\t{}\nyano3\t5327132\t{\"大室\":1,\"櫻子\":1,\"禁止\":1}\nyasakani\t6213462\t{\"南\":1,\"斗\":1,\"人間\":1,\"砲弾\":1}\nymotongpoo\t4135891\t{\"今日\":1,\"布教\":1}\nyukki7291\t16061414\t{\"fanta\":1,\"misaka\":1}\nzetamatta\t4030371\t{\"最近\":1,\"NYAOS\":1,\"的\":1,\"数\":1,\"年\":1,\"開発\":1,\"者\":1,\"私\":2,\"本来\":1,\"流入\":1,\"全て\":1,\"方\":1,\"流出\":1}\n"
    Reducer.run.should eql expected
  end
end
